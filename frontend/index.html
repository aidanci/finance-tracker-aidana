<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ’° Balancee </title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600&display=swap" rel="stylesheet">
</head>

<body>

<div class="app-header">
  <h1>ğŸŒ¿ BALANCEE</h1>
  <p class="subtitle">Your Finance Tracker</p>
</div>

  <div class="card" id="loginCard">
    <h2>Login</h2>
    <div class="controls">
      <input id="login" placeholder="Login" />
      <input id="password" type="password" placeholder="Password" />
      <button id="btnLogin">Login</button>
    </div>
  </div>

  <div class="card" id="appCard" style="display:none;">
    <h2>Add / Edit Transaction</h2>
    <div class="controls">
      <input id="id" type="hidden">
      <input id="title" placeholder="Title" required>
      <select id="category" required>
  <option value="" disabled selected>Select Category</option>
  <option value="Salary">ğŸ’¼ Salary</option>
  <option value="Freelance">ğŸ’» Freelance</option>
  <option value="Investment">ğŸ“ˆ Investment</option>
  <option value="Food">ğŸ½ï¸ Food</option>
  <option value="Groceries">ğŸ›’ Groceries</option>
  <option value="Rent">ğŸ  Rent</option>
  <option value="Utilities">ğŸ’¡ Utilities</option>
  <option value="Shopping">ğŸ‘œ Shopping</option>
  <option value="Health">ğŸ’Š Health</option>
  <option value="Entertainment">ğŸ¬ Entertainment</option>
  <option value="Travel">âœˆï¸ Travel</option>
  <option value="Education">ğŸ“š Education</option>
  <option value="Other">ğŸŒ¿ Other</option>
</select>
      <select id="type">
        <option value="income">Income</option>
        <option value="expense">Expense</option>
      </select>
      <input id="amount" type="number" step="0.01" placeholder="Amount" required>
      <input id="date" type="date" required>
      <button id="save">Save</button>
      <button id="reset" type="button" style="background:var(--muted);color:white;">Reset</button>
      <button id="btnLogout" style="background:var(--danger)">Logout</button>
    </div>

    <h2>All Transactions</h2>
    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Category</th>
          <th>Type</th>
          <th>Amount</th>
          <th>Date</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="rows"></tbody>
    </table>

    <div class="totals">
      <div class="income">Income: <span id="sumIncome">0</span> â‚¬</div>
      <div class="expense">Expense: <span id="sumExpense">0</span> â‚¬</div>
      <div>Balance: <span id="sumBalance">0</span> â‚¬</div>
    </div>
  </div>

  <footer>
    <p>Warsaw 2025</p>
  </footer>

  <script>
    const API = "/transactions";
    let token = localStorage.getItem("token") || "";

    const qs = s => document.querySelector(s);
    const rows = qs("#rows");
    const loginCard = qs("#loginCard");
    const appCard = qs("#appCard");

    const F = {
      id: qs("#id"),
      title: qs("#title"),
      category: qs("#category"),
      type: qs("#type"),
      amount: qs("#amount"),
      date: qs("#date")
    };

    function updateUI() {
      const loggedIn = !!token;
      loginCard.style.display = loggedIn ? "none" : "block";
      appCard.style.display = loggedIn ? "block" : "none";
    }

    qs("#btnLogin").onclick = async () => {
      const login = qs("#login").value.trim();
      const password = qs("#password").value.trim();
      if (!login || !password) return alert("Enter login and password!");

      if (login === "testuser" && password === "12345") {
        token = "demo-token";
        localStorage.setItem("token", token);
        alert("âœ… Logged in!");
        updateUI();
        list();
      } else {
        alert("âŒ Invalid credentials! Try admin / 1234");
      }
    };

    qs("#btnLogout").onclick = () => {
      localStorage.removeItem("token");
      token = "";
      updateUI();
    };

    async function list() {
      if (!token) return;
      const data = JSON.parse(localStorage.getItem("transactions") || "[]");
      let income = 0, expense = 0;
      rows.innerHTML = data.map((t, i) => {
        if (t.type === "income") income += t.amount;
        else expense += t.amount;
        return `
          <tr>
            <td>${t.title}</td>
            <td>${t.category}</td>
            <td>${t.type}</td>
            <td>${t.amount.toFixed(2)}</td>
            <td>${t.date}</td>
            <td>
              <button onclick="editT(${i})">âœï¸</button>
              <button onclick="delT(${i})" style="background:var(--danger)">ğŸ—‘ï¸</button>
            </td>
          </tr>`;
      }).join("");
      qs("#sumIncome").textContent = income.toFixed(2);
      qs("#sumExpense").textContent = expense.toFixed(2);
      qs("#sumBalance").textContent = (income - expense).toFixed(2);
    }

    window.editT = (i) => {
      const data = JSON.parse(localStorage.getItem("transactions") || "[]");
      const t = data[i];
      Object.keys(F).forEach(k => F[k].value = t[k]);
      F.id.value = i;
    };

    window.delT = (i) => {
      if (!confirm("Delete this transaction?")) return;
      const data = JSON.parse(localStorage.getItem("transactions") || "[]");
      data.splice(i, 1);
      localStorage.setItem("transactions", JSON.stringify(data));
      list();
    };

    qs("#save").onclick = () => {
      const newT = {
        title: F.title.value.trim(),
        category: F.category.value.trim(),
        type: F.type.value,
        amount: Number(F.amount.value),
        date: F.date.value
      };
      if (!newT.title || !newT.amount || !newT.date) return alert("Please fill all fields");
      const data = JSON.parse(localStorage.getItem("transactions") || "[]");
      if (F.id.value) data[F.id.value] = newT;
      else data.push(newT);
      localStorage.setItem("transactions", JSON.stringify(data));
      reset();
      list();
    };

    function reset() { Object.values(F).forEach(i => i.value = ""); }
    qs("#reset").onclick = reset;

    updateUI();
    if (token) list();

const container = document.querySelector('.floating-emojis');
const emojis = ['ğŸ’µ','ğŸ’°','ğŸ’¸','ğŸ’²'];

for (let i = 0; i < 25; i++) {
  const emoji = document.createElement('span');
  emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
  emoji.style.left = Math.random() * 100 + 'vw';
  emoji.style.fontSize = (Math.random() * 1.4 + 1.4) + 'rem';
  emoji.style.animationDuration = (8 + Math.random() * 10) + 's';
  emoji.style.animationDelay = Math.random() * 10 + 's';
  emoji.style.transform = `rotate(${Math.random() * 360}deg)`;
  container.appendChild(emoji);
}
  </script>
</body>
</html>